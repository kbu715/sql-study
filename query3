DROP TABLE EMP;
CREATE TABLE EMP(
    ENAME VARCHAR(20),
    SAL NUMBER);

DROP TABLE SALGRADE;
CREATE TABLE SALGRADE(
    GRADE NUMBER,
    LOSAL NUMBER,
    HISAL NUMBER
    );
    
    
INSERT INTO EMP VALUES('SMITH', 800);
INSERT INTO EMP VALUES('ALLEN', 1600);
INSERT INTO EMP VALUES('WARD', 1250);
INSERT INTO EMP VALUES('JONES', 2975);
INSERT INTO EMP VALUES('MARTIN', 1250);
INSERT INTO EMP VALUES('BLAKE', 2850);
INSERT INTO EMP VALUES('CLARK', 2450);
INSERT INTO EMP VALUES('SCOTT', 3000);
INSERT INTO EMP VALUES('KING', 5000);
INSERT INTO EMP VALUES('KDB', 3000);


INSERT INTO SALGRADE VALUES(1,700,1200);
INSERT INTO SALGRADE VALUES(2,1201,1400);
INSERT INTO SALGRADE VALUES(3,1401,2000);
INSERT INTO SALGRADE VALUES(4,2001,3000);
INSERT INTO SALGRADE VALUES(5,3001,9999);


SELECT *
    FROM EMP
    WHERE SAL > (SELECT SAL
                    FROM EMP
                    WHERE ENAME = 'JONES');
                    
                    
SELECT AVG(SAL) 
    FROM EMP;
    
SELECT *
    FROM EMP
    WHERE SAL > (SELECT AVG(SAL)
                 FROM EMP);
    
                    

--홍길동과 다른지역에 사는사람들을 검색하세요

DROP TABLE EMP2;
CREATE TABLE EMP2(
    ENAME VARCHAR(20),
    RESIDENCE VARCHAR(20));
    
    
INSERT INTO EMP2 VALUES('김덕배', '서울');
INSERT INTO EMP2 VALUES('홍길동', '제주');
INSERT INTO EMP2 VALUES('장재영', '울산');
INSERT INTO EMP2 VALUES('오지영', '부산');
INSERT INTO EMP2 VALUES('강바울', '대전');

SELECT * 
    FROM EMP2
    WHERE RESIDENCE != '제주';
    
SELECT *
    FROM EMP2
    WHERE ENAME != '홍길동';

--홍길동과 동일한 업무를 하는 사람은 (영업,생산,지원)
DROP TABLE EMP3;
CREATE TABLE EMP3(
    ENAME VARCHAR(20),
    RESIDENCE_CODE VARCHAR(20),
    JOB VARCHAR(20)
    );

INSERT INTO EMP3 VALUES('김덕배', 1, '영업');
INSERT INTO EMP3 VALUES('홍길동', 2, '생산');
INSERT INTO EMP3 VALUES('장재영', 3, '지원');
INSERT INTO EMP3 VALUES('오지영', 4, '영업');
INSERT INTO EMP3 VALUES('강바울', 5, '생산');
INSERT INTO EMP3 VALUES('정충휘', 6, '생산');
INSERT INTO EMP3 VALUES('최재형', 3, '지원');
INSERT INTO EMP3 VALUES('이형규', 2, '생산');
INSERT INTO EMP3 VALUES('최민준', 5, '영업');
INSERT INTO EMP3 VALUES('황승빈', 1, '지원');



SELECT * FROM EMP3;

--홍길동과 다른지역에서 근무하면서 동일한 업무를 하는 사람을 검색하세요

SELECT *
    FROM EMP3
    WHERE RESIDENCE != (SELECT RESIDENCE
                        FROM EMP3
                        WHERE ENAME = '홍길동')
    AND JOB IN (SELECT JOB
                    FROM EMP3
                    WHERE ENAME = '홍길동');
                    
SELECT * 
    FROM EMP3
    WHERE RESIDENCE = '부산';
    
DROP TABLE NUMRSDC;
CREATE TABLE NUMRSDC(
    RESIDENCE VARCHAR(20),
    CODE NUMBER
    ); 
    
INSERT INTO NUMRSDC VALUES('서울', 1);
INSERT INTO NUMRSDC VALUES('부산', 2);
INSERT INTO NUMRSDC VALUES('대전', 3);
INSERT INTO NUMRSDC VALUES('경기', 4);
INSERT INTO NUMRSDC VALUES('광주', 5);
INSERT INTO NUMRSDC VALUES('제주', 6);

SELECT * FROM EMP3;
SELECT * FROM NUMRSDC;

SELECT *
    FROM EMP3
    WHERE RESIDENCE_CODE = (SELECT CODE
                                FROM NUMRSDC
                                WHERE RESIDENCE = '부산');
                                
                                
                                
DROP TABLE EMP;
CREATE TABLE EMP(
    EMPNO NUMBER,
    ENAME VARCHAR2(20),
    JOB VARCHAR2(20),
    SAL NUMBER,
    DEPTNO NUMBER
    );

INSERT INTO EMP VALUES(1,'SCOTT','MANAGER',2975,20);
INSERT INTO EMP VALUES(2,'JONES','ANALYST',1250,30);
INSERT INTO EMP VALUES(3,'KDB','PLAYER',2850,40);
INSERT INTO EMP VALUES(4,'MESSI','PLAYER',5000,20);
INSERT INTO EMP VALUES(5,'NALDO','SALESMAN',1500,30);
INSERT INTO EMP VALUES(6,'NEYMAR','PRESIDENT',950,40);
INSERT INTO EMP VALUES(7,'MBAPPE','PLAYER',1600,20);


DROP TABLE DEPT;
CREATE TABLE DEPT(
    DEPTNO NUMBER,
    DNAME VARCHAR(20),
    LOC VARCHAR(20)
    );
    
INSERT INTO DEPT VALUES(20,'RESEARCH', 'DALLAS');
INSERT INTO DEPT VALUES(30,'SALES', 'DALLAS');
INSERT INTO DEPT VALUES(40,'MANAGEMENT', 'DALLAS');


SELECT *
    FROM EMP E, DEPT D
    WHERE E.DEPTNO = D.DEPTNO
        AND E.DEPTNO = 20
        AND E.SAL > (SELECT AVG(SAL)
                        FROM EMP);
                        
                        COMMIT;
